<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Clement Mugenzi" />

<meta name="date" content="2019-12-20" />

<title>Association between Gender and Salary Setting at the Houston College of Medicine</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Resume.html">Resume</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Titanic.html">Titanic</a>
    </li>
    <li>
      <a href="Gender_Salary.html">Gender and Salary Setting</a>
    </li>
  </ul>
</li>
<li>
  <a href="mailto:&lt;cm3928@cumc.columbia.edu.com&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/clement-mugenzi-1076a4106/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/mugenzi93/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/ClementMug">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Association between Gender and Salary Setting at the Houston College of Medicine</h1>
<h4 class="author">Clement Mugenzi</h4>
<h4 class="date">12/20/2019</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Income inequality between men and women has been a point of debate over the years. To find our own answers, our team sought to examine the association between salary and gender at the Houston college of medicine. This was a cross-sectional study based on the salaries among faculties with varying expertise in the field of medicine. We created two regression models of baseline salary in 1994 and the increment of salary between 1994 and 1995, according to gender, department, years of experience, work emphasis, certification status, and rank. We found that gender was significantly associated with salary setting at baseline but that it was not a determining factor for the salary increase from between 1994 and 1995.</p>
<p>Title VII of the Civil Rights Act of 1964 is a federal law that prohibits employers from discriminating against employees on the basis of sex, race, color, national origin and religion. Also, the equal pay act of 1963 requires that men and women in the same workplace be given equal pay for equal work. However, the U.S education system is one area that is not immune to this income gap problem. Several factors determine one’s compensation in the education system. Despite these legitimate factors that determine compensation, there are many cases that have been published claiming that female professors are getting paid less compared to their male colleagues while bearing the same, if not superior, titles or accolades. The aim of this study is to examine the association between gender discrimination in setting salary within the Houston college of medicine where a female professor claimed, through a district court lawsuit, that there was evidence of discrimination against women in giving promotions and setting salaries. To support this, we built multiple regressionmodels using six predictor variables such as the subject’s department, their area of expertise, whether or not they are board-certified, years of experience, and their position title. We tested for interactions and confounders that might be present between all the stated predictors and our main predictor of interest: the subject’s gender. Our response variables were the baseline salary in 1994 and the change in salary between 1994 and 1995.</p>
</div>
<div id="methods" class="section level1">
<h1>Methods</h1>
<div id="data-description" class="section level2">
<h2>Data Description</h2>
<ul>
<li>Deptartment: Academic departments at Houston College of medicine. Biochemistry, Physiology, Genetics, Pediatrics, Medicine, and Surgery</li>
<li>Gender: A dichotomous variable coded with dummy variables ‘1’ for Male subjects and ‘0’ for Female subjects</li>
<li>Emphasis: A dummy variable with 1 = Primarily clinical emphasis and 0 = Primarily research emphasis.</li>
<li>Certification: 1 = Board certified and 0 = not certified</li>
<li>Publication: Publication rate</li>
<li>Experience: years of experience since obtaining Medical Doctor degree.</li>
<li>Title: 1 = Assistant professor, 2 = Associate professor, 3 = full professor</li>
<li>Salary (1994): Salary in academic year 1994</li>
<li>Salary (1995): Salary in academic year 1995.</li>
</ul>
<p><strong>Loading and Tidying the dataset</strong></p>
<pre class="r"><code>lawsuit_df =
  read_csv(&quot;Data/Lawsuit.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;%
  rename(&quot;Department&quot; = &quot;dept&quot;, &quot;Emphasis&quot; = &quot;clin&quot;, &quot;Certification&quot; = &quot;cert&quot;,
         &quot;Title&quot; = &quot;rank&quot;, &quot;Experience&quot; = &quot;exper&quot;, &quot;Publication&quot; = &quot;prate&quot;,
         &quot;Salary (1994)&quot; = &quot;sal94&quot;, &quot;Salary (1995)&quot; = &quot;sal95&quot;) %&gt;%
  dplyr::mutate(
    Department = factor(Department, levels = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;,
                                   &quot;4&quot;, &quot;5&quot;, &quot;6&quot;)),
    gender = factor(gender, levels = c(&quot;1&quot;, &quot;0&quot;)),
    Emphasis = factor(Emphasis, levels = c(&quot;1&quot;, &quot;0&quot;)),
    Certification = factor(Certification, levels = c(&quot;1&quot;, &quot;0&quot;)),
    Title = factor(Title, levels = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;))) %&gt;% 
  mutate(
    gender = recode(gender, &quot;1&quot; = &quot;Male&quot;, &quot;0&quot; = &quot;Female&quot;),
    Department = recode(Department, &quot;1&quot; = &quot;Biochemistry&quot;, 
                        &quot;2&quot; = &quot;Physiology&quot;, &quot;3&quot; = &quot;Genetics&quot;,
                  &quot;4&quot; = &quot;Pediatrics&quot;, &quot;5&quot; = &quot;Medicine&quot;, &quot;6&quot; = &quot;Surgery&quot;),
    Emphasis = recode(Emphasis, &quot;1&quot; = &quot;Clinical&quot;, &quot;0&quot; = &quot;Research&quot;),
    Certification = recode(Certification, &quot;1&quot; = &quot;certified&quot;, 
                           &quot;0&quot; = &quot;Not certified&quot;),
    Title = recode(Title, &quot;1&quot; = &quot;Assistant Professor&quot;, 
                   &quot;2&quot; = &quot;Associate Professor&quot;, &quot;3&quot; = &quot;Full Professor&quot;)) %&gt;%
  arrange(gender)</code></pre>
<p>The dataset for analysis has 261 observations of 8 variables. The distributions of salary amount in 1994 and 1995 were originally skewed. A natural log transformation was applied to these two variables to exhibit a normal distribution.</p>
<pre class="r"><code>p1 = 
  lawsuit_df %&gt;% 
  ggplot(aes(x = `Salary (1994)`)) + 
  geom_histogram(aes(x = `Salary (1994)`, y = ..density..), alpha = .7) +
  geom_density(aes(x = `Salary (1994)`)) +
  theme(plot.title = element_text(hjust = .5)) +
  labs(
    x = &quot;Untransformed Salary (1994)&quot;) +
  theme_bw() +
  ggsci::scale_fill_lancet()

p2 = 
  lawsuit_df %&gt;% 
  ggplot(aes(x = `Salary (1995)`)) + 
  geom_histogram(aes(x = `Salary (1995)`, y = ..density..), alpha = .7) +
  geom_density(aes(x = `Salary (1995)`)) +
  theme(plot.title = element_text(hjust = .5)) +
  labs(
    x = &quot;Untransformed Salary (1995)&quot;) +
  theme_bw() +
  ggsci::scale_fill_lancet()

gridExtra::grid.arrange(p1, p2, ncol = 2)</code></pre>
<p><img src="Gender_Salary_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>lawsuit_df = 
  lawsuit_df %&gt;% 
  mutate(log_sal94 = log(`Salary (1994)`),
         log_sal95 = log(`Salary (1995)`),
         sal_increase = log(`Salary (1995)` - `Salary (1994)`))


p3 = 
  lawsuit_df %&gt;%
  ggplot(aes(x = log_sal94)) + 
  geom_histogram(aes(x = log_sal94, y = ..density..), alpha = .7) + 
  geom_density(aes(x = log_sal94)) +
  theme(plot.title = element_text(hjust = .5)) +
  labs(
    x = &quot;Log-Transformed Salary (1994)&quot;) +
  theme_bw() +
  ggsci::scale_fill_lancet()
p4 = 
  lawsuit_df %&gt;%
  ggplot(aes(x = log_sal95)) + 
  geom_histogram(aes(x = log_sal95, y = ..density..), alpha = .7) + 
  geom_density(aes(x = log_sal95)) +
  theme(plot.title = element_text(hjust = .5)) +
  labs(
    x = &quot;Log-Transformed Salary (1995)&quot;) +
  theme_bw() +
  ggsci::scale_fill_lancet()
gridExtra::grid.arrange(p3, p4, ncol = 2)</code></pre>
<p><img src="Gender_Salary_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code>a = lawsuit_df %&gt;%
  ggplot(aes(x = gender, fill = Department, y = log_sal94), alpha = .6) +
  geom_col(position = &quot;dodge&quot;) +
  ggsci:::scale_fill_lancet() +
  theme_bw() +
  labs(y = &quot;salary in 1994&quot;,
       title = &quot;Salary vs Department&quot;) 
b = lawsuit_df %&gt;%
  ggplot(aes(x = gender, fill = Emphasis, y = log_sal94),alpha = .6) +
  geom_col(position = &quot;dodge&quot;) +
  ggsci:::scale_fill_lancet() +
  theme_bw() +
  labs(y = &quot;salary in 1994&quot;,
       title = &quot;Salary vs Work Emphasis&quot;)
gridExtra::grid.arrange(a, b, nrow = 2)</code></pre>
<p><img src="Gender_Salary_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>c = lawsuit_df %&gt;%
  ggplot(aes(x = gender, fill = Certification, y = log_sal94),alpha = .6) +
  geom_col(position = &quot;dodge&quot;) +
  ggsci:::scale_fill_lancet() +
  theme_bw() +
  labs(y = &quot;salary in 1994&quot;,
       title = &quot;Salary vs Certification&quot;)
d = lawsuit_df %&gt;%
  ggplot(aes(x = gender, fill = Title, y = log_sal94),alpha = .6) +
  geom_col(position = &quot;dodge&quot;) +
  ggsci:::scale_fill_lancet() +
  theme_bw() +
  labs(y = &quot;salary in 1994&quot;,
       title = &quot;Salary vs Rank&quot;)
gridExtra::grid.arrange(c, d, nrow = 2)</code></pre>
<p><img src="Gender_Salary_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<p>The barplots above show the distribution of the 1994 salary against different predictor variables according to a subject’s gender. For instance, the first figure shows that overall surgeons are paid more compared to other specializations and that male surgeons are paid more compared to female surgeons at the Houston College of Medicine. Additionally, male full professors get paid more compared to female full professors. I will further explore what might be the reason for this when I build my models.</p>
<p><strong>Graphical Representation of potential interation between years of experience and salary adjusted for a subject’s gender:</strong></p>
<p>Below I will graphically explore the years of experience variable in relation to both the 1994 salary and salary increase from 1994 to 1995. It is important to highlight that salary has a linear relationship with years of experience. It is also important to highlight that if the lines are not parallel, it is evidence that the relationship between years of experience and salary will be determined by a subject’s gender, further validating the hypothesis of a presence of gender discrimination when it comes to salary setting.</p>
<pre class="r"><code>lawsuit_df %&gt;% 
  ggplot(aes(x = Experience, y = log_sal94, color = gender)) + 
  geom_point() + 
  geom_smooth(method = &quot;lm&quot;, se = FALSE) + 
  facet_grid(~Department) + 
  theme_bw()</code></pre>
<p><img src="Gender_Salary_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>In the scatterplot above, all lines cross which means that in all six departments, when all other variables are fixed, years of experience will not be the sole factor in determining the 1994 salary, gender will too.</p>
<pre class="r"><code>lawsuit_df %&gt;% 
  ggplot(aes(x = Experience, y = sal_increase, color = gender)) + 
  geom_point() + 
  geom_smooth(method = &quot;lm&quot;, se = FALSE) + 
  facet_grid(~Department) + 
  theme_bw()</code></pre>
<p><img src="Gender_Salary_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>As the previous scatterplot, the effect of years of experience toward salary increase will be modified by a subject’s gender, except in the <code>Pediatrics</code> department where there is not evidence of gender being a effect modifier of the relationship between years of experience and salary increase.</p>
<div id="table-1." class="section level3">
<h3>Table 1.</h3>
<p>Table 1 shows that the departments of Physiology, Genetics and Pediatrics had a significantly higher proportion of female faculties compared to the male, while the department of Surgery had a significantly lower proportion of female faculties. There was no significant difference in both clinical or research emphasis as well as certification between both genders. The results also presented that years after obtaining MD for females were shorter than that of males. By comparing the rank, which was also a proxy for productivity, the proportion of full professors among female faculties was much lesser than males.</p>
<pre class="r"><code># Cleaning output
tab1_controls = tableby.control(
               total = T,
               test = T,
               numeric.stats = c(&quot;meansd&quot;, &quot;medianq1q3&quot;, &quot;range&quot;),
               cat.stats = &quot;countpct&quot;,
               stats.labels = list(
               meansd = &quot;Mean (SD)&quot;,
               medianq1q3 = &quot;Median (Q1, Q3)&quot;,
               range = &quot;Min - Max&quot;,
               countpct = &quot;N (%)&quot;))

tab1 = tableby(gender ~ Department + Emphasis + Certification + Publication +
                  Experience + Title + `Salary (1994)` + `Salary (1995)`,
                data = lawsuit_df, control = tab1_controls)
summary(tab1, title = &#39;Descriptive Statistics&#39;, digits = 2, text = T)</code></pre>
<p><img src="images/Table1.jpg" /></p>
</div>
</div>
<div id="model-building" class="section level2">
<h2>Model Building</h2>
<p>I built two models for the analysis of the association between gender and salary. For Model 1, the goal was to check whether there was gender discrimination in the baseline salary in 1994. Since the main outcome was the salary amount and the main variable of interest was gender, I first regressed the salary in 1994 with only <code>gender</code> to test the direct association, and then added the potential confounders one at a time to see if these variables created a confounding effect. If the coefficient of <code>gender</code> changed directionality and/or there was a significant difference (10% in magnitude) after adding a new variable to the model, that variable would be considered a confounder. After checking all the potential confounders, interaction terms were added to the model for analyzing any interaction between gender and other factors. The second model generally followed the same structure as the first, However the main outcome in the second model was slightly different since it focused more on the salary increase from 1994 to 1995 rather than the baseline salary between both genders. The main response variable for both models were all log-transformed. There was one influential point in the dataset. I later decided to fit both models without the influential point after comparing the models fitted with and without it. The significance level in this study was set at <strong>0.05</strong>.</p>
<div id="model-information" class="section level3">
<h3>Model Information</h3>
<p>Model 1 accounted for the association between gender and baseline salary in 1994, adjusting for the department, work emphasis, certification, years since obtaining MD (years if experience) and Title. Model 2 accounted for the association between gender and salary increase in 1995, adjusting for the same variables. While there was no interaction effect in Model 2, Model 1 considered the interaction between gender and years of experience. Model diagnostics showed that both of the final models met the assumptions of multilinear regression and there was one influential point in the data.</p>
<p><strong>Checking for confounders:</strong></p>
<pre class="r"><code># fit
attach(lawsuit_df)
#based model
fit.base = lm(log_sal94 ~ gender)
summary(fit.base)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.13519 -0.36436 -0.00331  0.33580  1.05381 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  11.97055    0.03793 315.557  &lt; 2e-16 ***
## genderFemale -0.38624    0.05953  -6.489 4.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4723 on 259 degrees of freedom
## Multiple R-squared:  0.1398, Adjusted R-squared:  0.1365 
## F-statistic:  42.1 on 1 and 259 DF,  p-value: 4.378e-10</code></pre>
<pre class="r"><code># see if there is any confounder
output_model = vector()
output_add_var = vector()

for (i in 2:7 ) {
  var = names(lawsuit_df)[i] # ensure correct var names
  formula = as.formula(str_c(&quot;log_sal94 ~ gender +&quot;, var))
  print(str_c(&quot;log_sal94 ~ gender +&quot;, var))
  output_model = append(output_model, str_c(&quot;log_sal94 ~ gender +&quot;, var))
  output_add_var = append(output_add_var, var)
  }</code></pre>
<pre><code>## [1] &quot;log_sal94 ~ gender +Department&quot;
## [1] &quot;log_sal94 ~ gender +gender&quot;
## [1] &quot;log_sal94 ~ gender +Emphasis&quot;
## [1] &quot;log_sal94 ~ gender +Certification&quot;
## [1] &quot;log_sal94 ~ gender +Publication&quot;
## [1] &quot;log_sal94 ~ gender +Experience&quot;</code></pre>
<pre class="r"><code>confounder_check = tibble(model = output_model,
                             add_var = output_add_var)

regression = function(formula){
  formula = as.formula(formula)
  fit = lm(formula , data = lawsuit_df)
  return(as.tibble(broom::tidy(fit)))
}

confounder_check = 
  confounder_check %&gt;%
  mutate(reg = map(confounder_check$model,regression)) %&gt;%
  unnest() %&gt;%
  filter(p.value &lt; .05) %&gt;%
  filter(term == &quot;genderMale&quot;) %&gt;%
  mutate(confounder = ifelse(abs((estimate - 0.38624)/0.38326) &gt; 0.1, &quot;confounder&quot;,&quot;not confounder&quot; )) %&gt;%
  dplyr::select(-term)</code></pre>
<pre><code>## Warning: `as.tibble()` is deprecated, use `as_tibble()` (but mind the new semantics).
## This warning is displayed once per session.</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(reg)`</code></pre>
<pre class="r"><code>confounder_check %&gt;% kable(format = &quot;latex&quot;, booktabs = T, caption = &quot;Potential Confounders&quot;) %&gt;%
  kable_styling(latex_options = c(&quot;striped&quot;, &quot;hold_position&quot;),
                full_width = F)</code></pre>

<pre class="r"><code># all are confounders

#
summary(lm(log_sal94 ~ gender + Department + Emphasis + Certification + 
             Publication + Experience + Title, data = lawsuit_df))</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Publication + Experience + Title, data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.34833 -0.07668 -0.01446  0.08196  0.89241 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                11.47120    0.10035 114.310  &lt; 2e-16 ***
## genderFemale               -0.02089    0.02027  -1.030 0.303817    
## DepartmentPhysiology       -0.17620    0.02916  -6.043 5.50e-09 ***
## DepartmentGenetics          0.17021    0.03888   4.378 1.77e-05 ***
## DepartmentPediatrics        0.14848    0.05375   2.762 0.006169 ** 
## DepartmentMedicine          0.49591    0.04539  10.927  &lt; 2e-16 ***
## DepartmentSurgery           0.86754    0.06177  14.043  &lt; 2e-16 ***
## EmphasisResearch           -0.16065    0.04124  -3.896 0.000126 ***
## CertificationNot certified -0.19306    0.02129  -9.070  &lt; 2e-16 ***
## Publication                -0.02207    0.01741  -1.268 0.205970    
## Experience                  0.01798    0.00183   9.828  &lt; 2e-16 ***
## TitleAssociate Professor    0.13105    0.02365   5.542 7.63e-08 ***
## TitleFull Professor         0.21854    0.02637   8.286 7.39e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1338 on 248 degrees of freedom
## Multiple R-squared:  0.9339, Adjusted R-squared:  0.9307 
## F-statistic: 291.8 on 12 and 248 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><strong>Model 1 and 2 fitted with influential point:</strong></p>
<pre class="r"><code># test interaction between gender and other varibales
output_model = vector()
output_add_var = vector()

for (i in 2:6 ) {
  var = names(lawsuit_df)[i] # ensure correct var names
  formula = as.formula(str_c(&quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + Title +&quot;,&quot;gender*&quot;, var))
  print(str_c(&quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *&quot;, var))
  output_model = append(output_model, str_c(&quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + Title + gender *&quot;, var))
  output_add_var = append(output_add_var, var)
}</code></pre>
<pre><code>## [1] &quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *Department&quot;
## [1] &quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *gender&quot;
## [1] &quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *Emphasis&quot;
## [1] &quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *Certification&quot;
## [1] &quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *Publication&quot;</code></pre>
<pre class="r"><code>inter_check = 
  tibble(model = output_model,
       inter_with = output_add_var) %&gt;%
  mutate(reg = map(model,regression)) %&gt;%
  unnest() %&gt;%
  filter(p.value &lt; .05) %&gt;%
  filter(str_detect(term, &quot;:&quot;))</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(reg)`</code></pre>
<pre class="r"><code>inter_check</code></pre>
<pre><code>## # A tibble: 0 x 7
## # … with 7 variables: model &lt;chr&gt;, inter_with &lt;chr&gt;, term &lt;chr&gt;,
## #   estimate &lt;dbl&gt;, std.error &lt;dbl&gt;, statistic &lt;dbl&gt;, p.value &lt;dbl&gt;</code></pre>
<pre class="r"><code>summary(lm(log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender * Emphasis + gender * Experience , data = lawsuit_df))</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Publication + Experience + gender * Emphasis + gender * Experience, 
##     data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.36404 -0.08542 -0.00180  0.09212  0.77082 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   11.548849   0.108118 106.818  &lt; 2e-16 ***
## genderFemale                  -0.160514   0.040848  -3.930  0.00011 ***
## DepartmentPhysiology          -0.143174   0.031417  -4.557 8.14e-06 ***
## DepartmentGenetics             0.190514   0.042421   4.491 1.09e-05 ***
## DepartmentPediatrics           0.145867   0.057741   2.526  0.01215 *  
## DepartmentMedicine             0.485193   0.048808   9.941  &lt; 2e-16 ***
## DepartmentSurgery              0.848603   0.066740  12.715  &lt; 2e-16 ***
## EmphasisResearch              -0.089079   0.046630  -1.910  0.05724 .  
## CertificationNot certified    -0.185477   0.022810  -8.132 2.03e-14 ***
## Publication                   -0.028911   0.018671  -1.548  0.12279    
## Experience                     0.023180   0.001773  13.075  &lt; 2e-16 ***
## genderFemale:EmphasisResearch -0.119882   0.038711  -3.097  0.00218 ** 
## genderFemale:Experience        0.017764   0.003842   4.623 6.08e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1435 on 248 degrees of freedom
## Multiple R-squared:  0.9239, Adjusted R-squared:  0.9202 
## F-statistic:   251 on 12 and 248 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>interact.fit_1 = lm(log_sal94 ~ gender + Department + Emphasis + Certification + Experience + gender * Emphasis + gender * Experience , data = lawsuit_df)
summary(interact.fit_1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Experience + gender * Emphasis + gender * Experience, data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.34859 -0.08932  0.00184  0.09322  0.77560 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   11.393774   0.040855 278.882  &lt; 2e-16 ***
## genderFemale                  -0.168174   0.040661  -4.136 4.83e-05 ***
## DepartmentPhysiology          -0.142942   0.031505  -4.537 8.88e-06 ***
## DepartmentGenetics             0.213504   0.039850   5.358 1.92e-07 ***
## DepartmentPediatrics           0.212557   0.038567   5.511 8.88e-08 ***
## DepartmentMedicine             0.542518   0.031896  17.009  &lt; 2e-16 ***
## DepartmentSurgery              0.932959   0.038662  24.131  &lt; 2e-16 ***
## EmphasisResearch              -0.144395   0.030054  -4.805 2.68e-06 ***
## CertificationNot certified    -0.184092   0.022856  -8.054 3.31e-14 ***
## Experience                     0.022906   0.001769  12.949  &lt; 2e-16 ***
## genderFemale:EmphasisResearch -0.125412   0.038654  -3.244  0.00134 ** 
## genderFemale:Experience        0.017876   0.003852   4.640 5.63e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1439 on 249 degrees of freedom
## Multiple R-squared:  0.9232, Adjusted R-squared:  0.9198 
## F-statistic:   272 on 11 and 249 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>interact.fit_2 = lm(log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender * Emphasis + gender * Experience, 
                    data = lawsuit_df)
summary(interact.fit_2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Publication + Experience + gender * Emphasis + gender * Experience, 
##     data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.36404 -0.08542 -0.00180  0.09212  0.77082 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   11.548849   0.108118 106.818  &lt; 2e-16 ***
## genderFemale                  -0.160514   0.040848  -3.930  0.00011 ***
## DepartmentPhysiology          -0.143174   0.031417  -4.557 8.14e-06 ***
## DepartmentGenetics             0.190514   0.042421   4.491 1.09e-05 ***
## DepartmentPediatrics           0.145867   0.057741   2.526  0.01215 *  
## DepartmentMedicine             0.485193   0.048808   9.941  &lt; 2e-16 ***
## DepartmentSurgery              0.848603   0.066740  12.715  &lt; 2e-16 ***
## EmphasisResearch              -0.089079   0.046630  -1.910  0.05724 .  
## CertificationNot certified    -0.185477   0.022810  -8.132 2.03e-14 ***
## Publication                   -0.028911   0.018671  -1.548  0.12279    
## Experience                     0.023180   0.001773  13.075  &lt; 2e-16 ***
## genderFemale:EmphasisResearch -0.119882   0.038711  -3.097  0.00218 ** 
## genderFemale:Experience        0.017764   0.003842   4.623 6.08e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1435 on 248 degrees of freedom
## Multiple R-squared:  0.9239, Adjusted R-squared:  0.9202 
## F-statistic:   251 on 12 and 248 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>anova(interact.fit_1,interact.fit_2) </code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Experience + gender * Emphasis + gender * Experience
## Model 2: log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Publication + Experience + gender * Emphasis + gender * Experience
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1    249 5.1593                           
## 2    248 5.1099  1  0.049404 2.3977 0.1228</code></pre>
<pre class="r"><code># anova shows that smaller model(without publication) is superior (interact.fit_1)
# however, publication is a confounder, we still should include that variable 
#the resulting model is as below:
summary(interact.fit_2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Publication + Experience + gender * Emphasis + gender * Experience, 
##     data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.36404 -0.08542 -0.00180  0.09212  0.77082 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   11.548849   0.108118 106.818  &lt; 2e-16 ***
## genderFemale                  -0.160514   0.040848  -3.930  0.00011 ***
## DepartmentPhysiology          -0.143174   0.031417  -4.557 8.14e-06 ***
## DepartmentGenetics             0.190514   0.042421   4.491 1.09e-05 ***
## DepartmentPediatrics           0.145867   0.057741   2.526  0.01215 *  
## DepartmentMedicine             0.485193   0.048808   9.941  &lt; 2e-16 ***
## DepartmentSurgery              0.848603   0.066740  12.715  &lt; 2e-16 ***
## EmphasisResearch              -0.089079   0.046630  -1.910  0.05724 .  
## CertificationNot certified    -0.185477   0.022810  -8.132 2.03e-14 ***
## Publication                   -0.028911   0.018671  -1.548  0.12279    
## Experience                     0.023180   0.001773  13.075  &lt; 2e-16 ***
## genderFemale:EmphasisResearch -0.119882   0.038711  -3.097  0.00218 ** 
## genderFemale:Experience        0.017764   0.003842   4.623 6.08e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1435 on 248 degrees of freedom
## Multiple R-squared:  0.9239, Adjusted R-squared:  0.9202 
## F-statistic:   251 on 12 and 248 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>summary(interact.fit_1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Experience + gender * Emphasis + gender * Experience, data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.34859 -0.08932  0.00184  0.09322  0.77560 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   11.393774   0.040855 278.882  &lt; 2e-16 ***
## genderFemale                  -0.168174   0.040661  -4.136 4.83e-05 ***
## DepartmentPhysiology          -0.142942   0.031505  -4.537 8.88e-06 ***
## DepartmentGenetics             0.213504   0.039850   5.358 1.92e-07 ***
## DepartmentPediatrics           0.212557   0.038567   5.511 8.88e-08 ***
## DepartmentMedicine             0.542518   0.031896  17.009  &lt; 2e-16 ***
## DepartmentSurgery              0.932959   0.038662  24.131  &lt; 2e-16 ***
## EmphasisResearch              -0.144395   0.030054  -4.805 2.68e-06 ***
## CertificationNot certified    -0.184092   0.022856  -8.054 3.31e-14 ***
## Experience                     0.022906   0.001769  12.949  &lt; 2e-16 ***
## genderFemale:EmphasisResearch -0.125412   0.038654  -3.244  0.00134 ** 
## genderFemale:Experience        0.017876   0.003852   4.640 5.63e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1439 on 249 degrees of freedom
## Multiple R-squared:  0.9232, Adjusted R-squared:  0.9198 
## F-statistic:   272 on 11 and 249 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>#final model
interact.fit_1 = lm(log_sal94 ~ gender + Department + Emphasis + Certification + Experience + Title +  gender * Experience, data = lawsuit_df)
summary(interact.fit_1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Experience + Title + gender * Experience, data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.31858 -0.07715 -0.00925  0.07171  0.86349 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                11.375868   0.037208 305.738  &lt; 2e-16 ***
## genderFemale               -0.129868   0.037010  -3.509 0.000534 ***
## DepartmentPhysiology       -0.165800   0.028831  -5.751 2.60e-08 ***
## DepartmentGenetics          0.190825   0.035921   5.312 2.41e-07 ***
## DepartmentPediatrics        0.214562   0.035435   6.055 5.17e-09 ***
## DepartmentMedicine          0.547029   0.029121  18.785  &lt; 2e-16 ***
## DepartmentSurgery           0.937561   0.034999  26.788  &lt; 2e-16 ***
## EmphasisResearch           -0.204790   0.021526  -9.514  &lt; 2e-16 ***
## CertificationNot certified -0.184392   0.021024  -8.771 2.90e-16 ***
## Experience                  0.016006   0.001855   8.628 7.59e-16 ***
## TitleAssociate Professor    0.116911   0.023711   4.931 1.50e-06 ***
## TitleFull Professor         0.207293   0.026181   7.918 8.10e-14 ***
## genderFemale:Experience     0.011670   0.003590   3.251 0.001310 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1315 on 248 degrees of freedom
## Multiple R-squared:  0.9361, Adjusted R-squared:  0.9331 
## F-statistic:   303 on 12 and 248 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="images/with.jpg" /></p>
<p>The influential point indicated that a male faculty with only 2 years of working experience had an extremely high salary compared to others. I fitted another model without this influential point and below is the diagnostics showing the influntial point (113).</p>
<p><strong>Diagnostics for model 1 with the influential point:</strong></p>
<pre class="r"><code>par(mfrow = c(2,2))
plot(interact.fit_1)</code></pre>
<p><img src="Gender_Salary_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p><strong>Model 1 and 2 fitted without the influential point:</strong></p>
<pre class="r"><code>lawsuit_df = lawsuit_df[-113,]

# test interaction between gender and other varibales
output_model = vector()
output_add_var = vector()

for (i in 2:6 ) {
  var = names(lawsuit_df)[i] # ensure correct var names
  formula = as.formula(str_c(&quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + Title +&quot;,&quot;gender*&quot;, var))
  print(str_c(&quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *&quot;, var))
  output_model = append(output_model, str_c(&quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + Title + gender *&quot;, var))
  output_add_var = append(output_add_var, var)
}</code></pre>
<pre><code>## [1] &quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *Department&quot;
## [1] &quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *gender&quot;
## [1] &quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *Emphasis&quot;
## [1] &quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *Certification&quot;
## [1] &quot;log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender *Publication&quot;</code></pre>
<pre class="r"><code>inter_check = 
  tibble(model = output_model,
       inter_with = output_add_var) %&gt;%
  mutate(reg = map(model,regression)) %&gt;%
  unnest() %&gt;%
  filter(p.value &lt; .05) %&gt;%
  filter(str_detect(term, &quot;:&quot;))</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(reg)`</code></pre>
<pre class="r"><code>inter_check</code></pre>
<pre><code>## # A tibble: 0 x 7
## # … with 7 variables: model &lt;chr&gt;, inter_with &lt;chr&gt;, term &lt;chr&gt;,
## #   estimate &lt;dbl&gt;, std.error &lt;dbl&gt;, statistic &lt;dbl&gt;, p.value &lt;dbl&gt;</code></pre>
<pre class="r"><code>summary(lm(log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender * Emphasis + gender * Experience , data = lawsuit_df))</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Publication + Experience + gender * Emphasis + gender * Experience, 
##     data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.34969 -0.08757  0.00075  0.09526  0.36916 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   11.544270   0.101397 113.852  &lt; 2e-16 ***
## genderFemale                  -0.144751   0.038400  -3.770 0.000205 ***
## DepartmentPhysiology          -0.149529   0.029483  -5.072 7.75e-07 ***
## DepartmentGenetics             0.184410   0.039797   4.634 5.82e-06 ***
## DepartmentPediatrics           0.135673   0.054178   2.504 0.012918 *  
## DepartmentMedicine             0.464773   0.045903  10.125  &lt; 2e-16 ***
## DepartmentSurgery              0.836661   0.062622  13.360  &lt; 2e-16 ***
## EmphasisResearch              -0.117065   0.043985  -2.661 0.008291 ** 
## CertificationNot certified    -0.197868   0.021493  -9.206  &lt; 2e-16 ***
## Publication                   -0.026609   0.017514  -1.519 0.129961    
## Experience                     0.024223   0.001672  14.488  &lt; 2e-16 ***
## genderFemale:EmphasisResearch -0.103603   0.036408  -2.846 0.004805 ** 
## genderFemale:Experience        0.016173   0.003613   4.476 1.16e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1346 on 247 degrees of freedom
## Multiple R-squared:  0.933,  Adjusted R-squared:  0.9297 
## F-statistic: 286.5 on 12 and 247 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>interact.fit_3 = lm(log_sal94 ~ gender + Department + Emphasis + Certification + Experience + gender * Emphasis + gender * Experience , data = lawsuit_df)
summary(interact.fit_3)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Experience + gender * Emphasis + gender * Experience, data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.35513 -0.08520  0.00255  0.09249  0.36542 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   11.401585   0.038331 297.453  &lt; 2e-16 ***
## genderFemale                  -0.151707   0.038226  -3.969 9.47e-05 ***
## DepartmentPhysiology          -0.149353   0.029561  -5.052 8.47e-07 ***
## DepartmentGenetics             0.205524   0.037390   5.497 9.59e-08 ***
## DepartmentPediatrics           0.196966   0.036258   5.432 1.33e-07 ***
## DepartmentMedicine             0.517393   0.030206  17.129  &lt; 2e-16 ***
## DepartmentSurgery              0.914196   0.036389  25.123  &lt; 2e-16 ***
## EmphasisResearch              -0.168112   0.028462  -5.906 1.15e-08 ***
## CertificationNot certified    -0.196665   0.021535  -9.132  &lt; 2e-16 ***
## Experience                     0.023977   0.001668  14.371  &lt; 2e-16 ***
## genderFemale:EmphasisResearch -0.108598   0.036355  -2.987   0.0031 ** 
## genderFemale:Experience        0.016266   0.003622   4.490 1.09e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.135 on 248 degrees of freedom
## Multiple R-squared:  0.9323, Adjusted R-squared:  0.9293 
## F-statistic: 310.7 on 11 and 248 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>interact.fit_4 = lm(log_sal94 ~ gender + Department + Emphasis + Certification + Publication + Experience + gender * Emphasis + gender * Experience, 
                    data = lawsuit_df)
summary(interact.fit_4)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Publication + Experience + gender * Emphasis + gender * Experience, 
##     data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.34969 -0.08757  0.00075  0.09526  0.36916 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   11.544270   0.101397 113.852  &lt; 2e-16 ***
## genderFemale                  -0.144751   0.038400  -3.770 0.000205 ***
## DepartmentPhysiology          -0.149529   0.029483  -5.072 7.75e-07 ***
## DepartmentGenetics             0.184410   0.039797   4.634 5.82e-06 ***
## DepartmentPediatrics           0.135673   0.054178   2.504 0.012918 *  
## DepartmentMedicine             0.464773   0.045903  10.125  &lt; 2e-16 ***
## DepartmentSurgery              0.836661   0.062622  13.360  &lt; 2e-16 ***
## EmphasisResearch              -0.117065   0.043985  -2.661 0.008291 ** 
## CertificationNot certified    -0.197868   0.021493  -9.206  &lt; 2e-16 ***
## Publication                   -0.026609   0.017514  -1.519 0.129961    
## Experience                     0.024223   0.001672  14.488  &lt; 2e-16 ***
## genderFemale:EmphasisResearch -0.103603   0.036408  -2.846 0.004805 ** 
## genderFemale:Experience        0.016173   0.003613   4.476 1.16e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1346 on 247 degrees of freedom
## Multiple R-squared:  0.933,  Adjusted R-squared:  0.9297 
## F-statistic: 286.5 on 12 and 247 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>anova(interact.fit_3,interact.fit_4) </code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Experience + gender * Emphasis + gender * Experience
## Model 2: log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Publication + Experience + gender * Emphasis + gender * Experience
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1    248 4.5178                           
## 2    247 4.4760  1   0.04183 2.3083   0.13</code></pre>
<pre class="r"><code># anova shows that smaller model(without publication) is superior (interact.fit_1)
# however, publication is a confounder, we still should include that variable 
#the resulting model is as below:
summary(interact.fit_4)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Publication + Experience + gender * Emphasis + gender * Experience, 
##     data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.34969 -0.08757  0.00075  0.09526  0.36916 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   11.544270   0.101397 113.852  &lt; 2e-16 ***
## genderFemale                  -0.144751   0.038400  -3.770 0.000205 ***
## DepartmentPhysiology          -0.149529   0.029483  -5.072 7.75e-07 ***
## DepartmentGenetics             0.184410   0.039797   4.634 5.82e-06 ***
## DepartmentPediatrics           0.135673   0.054178   2.504 0.012918 *  
## DepartmentMedicine             0.464773   0.045903  10.125  &lt; 2e-16 ***
## DepartmentSurgery              0.836661   0.062622  13.360  &lt; 2e-16 ***
## EmphasisResearch              -0.117065   0.043985  -2.661 0.008291 ** 
## CertificationNot certified    -0.197868   0.021493  -9.206  &lt; 2e-16 ***
## Publication                   -0.026609   0.017514  -1.519 0.129961    
## Experience                     0.024223   0.001672  14.488  &lt; 2e-16 ***
## genderFemale:EmphasisResearch -0.103603   0.036408  -2.846 0.004805 ** 
## genderFemale:Experience        0.016173   0.003613   4.476 1.16e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1346 on 247 degrees of freedom
## Multiple R-squared:  0.933,  Adjusted R-squared:  0.9297 
## F-statistic: 286.5 on 12 and 247 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>summary(interact.fit_3)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Experience + gender * Emphasis + gender * Experience, data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.35513 -0.08520  0.00255  0.09249  0.36542 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   11.401585   0.038331 297.453  &lt; 2e-16 ***
## genderFemale                  -0.151707   0.038226  -3.969 9.47e-05 ***
## DepartmentPhysiology          -0.149353   0.029561  -5.052 8.47e-07 ***
## DepartmentGenetics             0.205524   0.037390   5.497 9.59e-08 ***
## DepartmentPediatrics           0.196966   0.036258   5.432 1.33e-07 ***
## DepartmentMedicine             0.517393   0.030206  17.129  &lt; 2e-16 ***
## DepartmentSurgery              0.914196   0.036389  25.123  &lt; 2e-16 ***
## EmphasisResearch              -0.168112   0.028462  -5.906 1.15e-08 ***
## CertificationNot certified    -0.196665   0.021535  -9.132  &lt; 2e-16 ***
## Experience                     0.023977   0.001668  14.371  &lt; 2e-16 ***
## genderFemale:EmphasisResearch -0.108598   0.036355  -2.987   0.0031 ** 
## genderFemale:Experience        0.016266   0.003622   4.490 1.09e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.135 on 248 degrees of freedom
## Multiple R-squared:  0.9323, Adjusted R-squared:  0.9293 
## F-statistic: 310.7 on 11 and 248 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>#final model
interact.fit_3 = lm(log_sal94 ~ gender + Department + Emphasis + Certification + Experience + Title +  gender * Experience, data = lawsuit_df)
summary(interact.fit_3)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_sal94 ~ gender + Department + Emphasis + Certification + 
##     Experience + Title + gender * Experience, data = lawsuit_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.32706 -0.07187 -0.01347  0.07846  0.28275 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                11.377558   0.033648 338.135  &lt; 2e-16 ***
## genderFemale               -0.099172   0.033717  -2.941  0.00358 ** 
## DepartmentPhysiology       -0.173140   0.026090  -6.636 2.02e-10 ***
## DepartmentGenetics          0.185038   0.032493   5.695 3.50e-08 ***
## DepartmentPediatrics        0.195409   0.032146   6.079 4.56e-09 ***
## DepartmentMedicine          0.520220   0.026576  19.575  &lt; 2e-16 ***
## DepartmentSurgery           0.920340   0.031733  29.003  &lt; 2e-16 ***
## EmphasisResearch           -0.222586   0.019610 -11.350  &lt; 2e-16 ***
## CertificationNot certified -0.201139   0.019143 -10.507  &lt; 2e-16 ***
## Experience                  0.016858   0.001681  10.026  &lt; 2e-16 ***
## TitleAssociate Professor    0.130208   0.021515   6.052 5.28e-09 ***
## TitleFull Professor         0.215747   0.023702   9.102  &lt; 2e-16 ***
## genderFemale:Experience     0.009631   0.003258   2.957  0.00341 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1189 on 247 degrees of freedom
## Multiple R-squared:  0.9477, Adjusted R-squared:  0.9452 
## F-statistic:   373 on 12 and 247 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="images/without.jpg" /></p>
<p>However, considering the salary increase between 1994 and 1995 based on Model 2, gender only had a slight influence on the difference in the increment. Surprisingly, even though males had a higher baseline salary, females tend to receive a larger salary increase compared to male subjects. There was a relatively smaller association between males and the salary increase, which implied that gender equality in the income growth was almost achieved in 1995, though the inequality still existed at the baseline level of salary of 1994.</p>
<p><strong>Diagnostics for model 1 without the influential point:</strong></p>
<pre class="r"><code>par(mfrow = c(2,2))
plot(interact.fit_3)</code></pre>
<p><img src="Gender_Salary_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>For further analysis, Model 1 was stratified by each of the included confounders. While being stratified by the departments, the results showed that males were more likely to receive higher baseline salaries than females in the Department of Physiology and Medicine. The gender difference still existed after adjusting for other confounders except for experienced years. While adjusting for experienced years, I found that there was no significant difference in baseline salary between both genders.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
