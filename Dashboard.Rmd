---
title: "Dashboard"
author: "Clement Mugenzi"
date: "10/27/2019"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(viridis)
library(p8105.datasets)
library(plotly)
```

## Changing the Dataset to a usable Form

I am using the instacart dataset, a platform which allows its clients to shop online from local stores.


```{r}
set.seed(1)

data("instacart")

 
instacart = 
  instacart %>% 
  mutate(
    order_dow = recode(order_dow, "0" = "Sunday", "1" = "Monday", 
                       "2" = "Tuesday", "3" = "Wednesday", 
                       "4" = "Thursday", "5" = "Friday", 
                       "6" = "Saturday"), 
    order_dow = factor(order_dow, levels = c("Monday", "Tuesday", 
                                             "Wednesday", "Thursday", 
                                             "Friday", "Saturday",
                                             "Sunday"))) %>% 
  select(aisle, department, product_name, order_hour_of_day, order_dow) %>% 
  sample_n(500)
```

## Scatterplot

```{r}
instacart %>% 
  filter(order_hour_of_day %in% 11:14) %>% 
  mutate(text_label = str_c(product_name, order_dow)) %>% 
  plot_ly(
    x = ~aisle, y = ~department, type = "scatter", mode = "markers",
    color = ~order_hour_of_day, text = ~text_label, alpha = 0.5)
```

## Bar Plot

The bar plot below shows the number of orders per day with Sunday being the day most people seem to do most online shopping. 


```{r}
instacart %>% 
  count(order_dow) %>% 
  mutate(fct_reorder(order_dow, n)) %>% 
  plot_ly(x = ~order_dow, y = ~n, color = ~order_dow, type = "bar") %>% 
  layout(xaxis = list(title = "Day", tickangle = -45),
         yaxis = list(title = "Number of Orders"),
         margin = list(b = 100),
         barmode = 'group')
```


## Boxplot

```{r}
common_aisle = 
  instacart %>% 
  filter(aisle == c("fresh vegetables", "fresh fruits", "packaged vegetables fruits",
         "yogurt", "packaged cheese", "water seltzer sparkling water")) %>%
  count(aisle, sort = TRUE)
```


The following boxlot showcases descriptive statistics for the selected aisles and as to what time of day they most likely were frequented. Fresh vegetables and Packaged vegetables fruits are both equally spread out with range of 22 hours. 

```{r}
inner_join(instacart, common_aisle, by = "aisle") %>% 
  mutate(aisle = fct_reorder(aisle, order_hour_of_day)) %>%
  plot_ly(y = ~order_hour_of_day, color = ~aisle, type = "box",
          colors = "Set2") %>% 
  layout(yaxis = list(title = "Hour of Day"))
```












