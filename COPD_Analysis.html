<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Clement Mugenzi" />


<title>Longitudinal Analysis of sLTPs/QES</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="site_libs/d3-4.5.0/d3.min.js"></script>
<script src="site_libs/sankey-1/sankey.js"></script>
<script src="site_libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Resume.html">Resume</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Titanic.html">Titanic</a>
    </li>
    <li>
      <a href="GreenTaxi.html">Green Taxi - Percentage Tip</a>
    </li>
    <li>
      <a href="COPD_Analysis.html">COPD - Progression of sLTP/QES</a>
    </li>
  </ul>
</li>
<li>
  <a href="mailto:&lt;cm3928@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/clement-mugenzi-1076a4106/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/mugenzi93/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/ClementMug">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Longitudinal Analysis of sLTPs/QES</h1>
<h4 class="author">Clement Mugenzi</h4>
<h4 class="date">8/3/2020</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This document explore the longitudinal progression of emphysema subtypes (sLTPs/QES) over time - from either baseline or any other QES form to after 5 or 6 years later and so on. The dataset is comprised of CT scans from COPD patients.</p>
<p>Different patients have different proportions on emphysema, so that is why also different pixels (corresponding to the number of observations) were recorded - What I call multiple measures. In other words, different patients had different number of QES pixels labeled for their lungs.</p>
<p><strong>Data Description:</strong></p>
<ul>
<li><p><strong>IDNO:</strong> Patient ID Number</p></li>
<li><p><strong>X,Y,Z:</strong> Pixel coordinates</p></li>
<li><p><strong>sLTP(COPD1);NE = -1:</strong> Baseline Spatially-Informed Lung Texture Patterns, where -1 means ‘No Emphysema’ and where sLTPs span a 1-10 range.</p></li>
<li><p><strong>sLTP(COPD2);NE = -1:</strong> Spatially-Informed Lung Texture Patterns at follow up.</p></li>
<li><p><strong>Key Definitions: NE = No Emphyesema</strong></p></li>
</ul>
</div>
<div id="exploratory-data-analysis" class="section level1">
<h1>Exploratory Data Analysis</h1>
<div id="no-emphysema-ne-is-included" class="section level2">
<h2>No Emphysema (NE) is Included</h2>
<div id="the-idno-variable" class="section level3">
<h3>The IDNO variable</h3>
<p><strong>Number of patients (including those with NE):</strong></p>
<p>I will count the number of patients by counting distinct IDs.</p>
<pre><code>##     n
## 1 126</code></pre>
<p>There are <strong>126</strong> patients with differing CT scans measurements.</p>
<p>Next, we explore patients who were eliminated due to the elimination of unwanted <em>multiple lung locations</em> in the dataset. In brief, transitions <strong>from QES to NE</strong> constituted the entirety of the multiple measurements we did not want to include in the research study. Therefore, this research only included valid transitions, meaning <strong>NE to NE, NE to QES, and QES to QES.</strong></p>

</div>
<div id="basic-statistics" class="section level3">
<h3>Basic Statistics</h3>
<table>
<caption>Descriptive Statistics</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Overall (N=2808544)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">x</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- Mean (SD)</td>
<td align="center">211.70 (114.25)</td>
</tr>
<tr class="odd">
<td align="left">- Median (Q1, Q3)</td>
<td align="center">237.00 (102.00, 311.00)</td>
</tr>
<tr class="even">
<td align="left">- Min - Max</td>
<td align="center">21.00 - 462.00</td>
</tr>
<tr class="odd">
<td align="left">y</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- Mean (SD)</td>
<td align="center">132.15 (65.32)</td>
</tr>
<tr class="odd">
<td align="left">- Median (Q1, Q3)</td>
<td align="center">124.00 (79.00, 180.00)</td>
</tr>
<tr class="even">
<td align="left">- Min - Max</td>
<td align="center">18.00 - 342.00</td>
</tr>
<tr class="odd">
<td align="left">z</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- Mean (SD)</td>
<td align="center">256.74 (110.92)</td>
</tr>
<tr class="odd">
<td align="left">- Median (Q1, Q3)</td>
<td align="center">255.00 (169.00, 343.00)</td>
</tr>
<tr class="even">
<td align="left">- Min - Max</td>
<td align="center">18.00 - 607.00</td>
</tr>
<tr class="odd">
<td align="left">qes_baseline</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- NE</td>
<td align="center">2355152 (83.9%)</td>
</tr>
<tr class="odd">
<td align="left">- Vanishing</td>
<td align="center">9203 (0.3%)</td>
</tr>
<tr class="even">
<td align="left">- Apical</td>
<td align="center">80523 (2.9%)</td>
</tr>
<tr class="odd">
<td align="left">- Diffuse</td>
<td align="center">177548 (6.3%)</td>
</tr>
<tr class="even">
<td align="left">- Senile</td>
<td align="center">109652 (3.9%)</td>
</tr>
<tr class="odd">
<td align="left">- oCPFE</td>
<td align="center">41034 (1.5%)</td>
</tr>
<tr class="even">
<td align="left">- rCPFE</td>
<td align="center">35432 (1.3%)</td>
</tr>
<tr class="odd">
<td align="left">qes_follow_up</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- NE</td>
<td align="center">2146336 (76.4%)</td>
</tr>
<tr class="odd">
<td align="left">- Vanishing</td>
<td align="center">14798 (0.5%)</td>
</tr>
<tr class="even">
<td align="left">- Apical</td>
<td align="center">136795 (4.9%)</td>
</tr>
<tr class="odd">
<td align="left">- Diffuse</td>
<td align="center">218556 (7.8%)</td>
</tr>
<tr class="even">
<td align="left">- Senile</td>
<td align="center">163094 (5.8%)</td>
</tr>
<tr class="odd">
<td align="left">- oCPFE</td>
<td align="center">71878 (2.6%)</td>
</tr>
<tr class="even">
<td align="left">- rCPFE</td>
<td align="center">57087 (2.0%)</td>
</tr>
</tbody>
</table>
<ul>
<li><p>From this <strong>Table 1.</strong> we can identify descriptive statistics of the 3D coordinates (x,y,z) and also the rarest of QES at both baseline and follow-up.</p></li>
<li><p>At baseline, two of the rarest QES are <strong>Vanishing Lung</strong> and <strong>Retrictive CPFE</strong> which only appears <strong>1.4%</strong> and <strong>5.4%</strong> of the times respectively.</p></li>
<li><p>At follow-up, two of the rarest QES are also <strong>Vanishing Lung</strong> and <strong>Restrictive CPFE</strong> which appears <strong>2.2%</strong> and <strong>8.6%</strong> of the times respectively.</p></li>
<li><p>Another important observation was that the order with respect to prevalence of QES did not change from baseline to follow up where the diffuse QES occured the most followed by Senile then Apical.</p></li>
</ul>

<table>
<caption>Descriptive Statistics - Excluding No Emphysema</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Overall (N=453392)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">qes_baseline</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- Vanishing</td>
<td align="center">9203 (2.0%)</td>
</tr>
<tr class="odd">
<td align="left">- Apical</td>
<td align="center">80523 (17.8%)</td>
</tr>
<tr class="even">
<td align="left">- Diffuse</td>
<td align="center">177548 (39.2%)</td>
</tr>
<tr class="odd">
<td align="left">- Senile</td>
<td align="center">109652 (24.2%)</td>
</tr>
<tr class="even">
<td align="left">- oCPFE</td>
<td align="center">41034 (9.1%)</td>
</tr>
<tr class="odd">
<td align="left">- rCPFE</td>
<td align="center">35432 (7.8%)</td>
</tr>
<tr class="even">
<td align="left">qes_follow_up</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- Vanishing</td>
<td align="center">14768 (3.3%)</td>
</tr>
<tr class="even">
<td align="left">- Apical</td>
<td align="center">122071 (26.9%)</td>
</tr>
<tr class="odd">
<td align="left">- Diffuse</td>
<td align="center">166596 (36.7%)</td>
</tr>
<tr class="even">
<td align="left">- Senile</td>
<td align="center">88983 (19.6%)</td>
</tr>
<tr class="odd">
<td align="left">- oCPFE</td>
<td align="center">29380 (6.5%)</td>
</tr>
<tr class="even">
<td align="left">- rCPFE</td>
<td align="center">31594 (7.0%)</td>
</tr>
</tbody>
</table>
<p>The table above represents percent frequencies of transitions from QES to QES, excluding No Emphysema at both baseline and follow up.</p>

<p><strong>Number of measured lung locations per patient (Excluding NE):</strong></p>
<p>I will use the <em>group_by</em> function to count how many times a particular ID appears, meaning how many times a single patient’s CT scan was taken.</p>
<p><strong>Table 3: Measured Locations per Patient</strong></p>
<table>
<thead>
<tr class="header">
<th align="right">idno</th>
<th align="left">multiple_locations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4010100</td>
<td align="left">26,384</td>
</tr>
<tr class="even">
<td align="right">4010700</td>
<td align="left">14,162</td>
</tr>
<tr class="odd">
<td align="right">4010800</td>
<td align="left">12,992</td>
</tr>
<tr class="even">
<td align="right">4011000</td>
<td align="left">32,308</td>
</tr>
<tr class="odd">
<td align="right">4011200</td>
<td align="left">8,698</td>
</tr>
<tr class="even">
<td align="right">4011700</td>
<td align="left">13,748</td>
</tr>
<tr class="odd">
<td align="right">4012000</td>
<td align="left">18,249</td>
</tr>
<tr class="even">
<td align="right">4012200</td>
<td align="left">15,750</td>
</tr>
<tr class="odd">
<td align="right">4012500</td>
<td align="left">10,657</td>
</tr>
<tr class="even">
<td align="right">4013200</td>
<td align="left">12,978</td>
</tr>
<tr class="odd">
<td align="right">4014400</td>
<td align="left">13,249</td>
</tr>
<tr class="even">
<td align="right">4014800</td>
<td align="left">10,955</td>
</tr>
<tr class="odd">
<td align="right">4014900</td>
<td align="left">25,000</td>
</tr>
<tr class="even">
<td align="right">4015000</td>
<td align="left">12,475</td>
</tr>
<tr class="odd">
<td align="right">4015300</td>
<td align="left">16,846</td>
</tr>
<tr class="even">
<td align="right">4015500</td>
<td align="left">12,892</td>
</tr>
<tr class="odd">
<td align="right">4015900</td>
<td align="left">11,549</td>
</tr>
<tr class="even">
<td align="right">4016100</td>
<td align="left">15,065</td>
</tr>
<tr class="odd">
<td align="right">4016800</td>
<td align="left">21,555</td>
</tr>
<tr class="even">
<td align="right">4017200</td>
<td align="left">17,049</td>
</tr>
<tr class="odd">
<td align="right">4017500</td>
<td align="left">41,971</td>
</tr>
<tr class="even">
<td align="right">4017600</td>
<td align="left">36,159</td>
</tr>
<tr class="odd">
<td align="right">4017700</td>
<td align="left">12,533</td>
</tr>
<tr class="even">
<td align="right">4017900</td>
<td align="left">12,388</td>
</tr>
<tr class="odd">
<td align="right">4018000</td>
<td align="left">16,847</td>
</tr>
<tr class="even">
<td align="right">4018700</td>
<td align="left">12,996</td>
</tr>
<tr class="odd">
<td align="right">4019100</td>
<td align="left">20,945</td>
</tr>
<tr class="even">
<td align="right">4019300</td>
<td align="left">16,943</td>
</tr>
<tr class="odd">
<td align="right">4019400</td>
<td align="left">12,801</td>
</tr>
<tr class="even">
<td align="right">4021300</td>
<td align="left">12,602</td>
</tr>
<tr class="odd">
<td align="right">4021900</td>
<td align="left">10,520</td>
</tr>
<tr class="even">
<td align="right">4022100</td>
<td align="left">29,040</td>
</tr>
<tr class="odd">
<td align="right">4022200</td>
<td align="left">12,637</td>
</tr>
<tr class="even">
<td align="right">4022300</td>
<td align="left">6,591</td>
</tr>
<tr class="odd">
<td align="right">4022500</td>
<td align="left">13,511</td>
</tr>
<tr class="even">
<td align="right">4022600</td>
<td align="left">11,903</td>
</tr>
<tr class="odd">
<td align="right">4022900</td>
<td align="left">12,419</td>
</tr>
<tr class="even">
<td align="right">4023000</td>
<td align="left">28,724</td>
</tr>
<tr class="odd">
<td align="right">4400000</td>
<td align="left">8,449</td>
</tr>
<tr class="even">
<td align="right">4400100</td>
<td align="left">77,850</td>
</tr>
<tr class="odd">
<td align="right">4400200</td>
<td align="left">83,262</td>
</tr>
<tr class="even">
<td align="right">4400300</td>
<td align="left">102,419</td>
</tr>
<tr class="odd">
<td align="right">4400400</td>
<td align="left">47,588</td>
</tr>
<tr class="even">
<td align="right">4400500</td>
<td align="left">97,408</td>
</tr>
<tr class="odd">
<td align="right">4400600</td>
<td align="left">77,744</td>
</tr>
<tr class="even">
<td align="right">4400700</td>
<td align="left">61,381</td>
</tr>
<tr class="odd">
<td align="right">4400800</td>
<td align="left">76,524</td>
</tr>
<tr class="even">
<td align="right">4400900</td>
<td align="left">83,427</td>
</tr>
<tr class="odd">
<td align="right">4401000</td>
<td align="left">45,258</td>
</tr>
<tr class="even">
<td align="right">4401100</td>
<td align="left">51,444</td>
</tr>
<tr class="odd">
<td align="right">4401300</td>
<td align="left">43,457</td>
</tr>
<tr class="even">
<td align="right">4401400</td>
<td align="left">31,919</td>
</tr>
<tr class="odd">
<td align="right">4401500</td>
<td align="left">44,606</td>
</tr>
<tr class="even">
<td align="right">4401600</td>
<td align="left">46,492</td>
</tr>
<tr class="odd">
<td align="right">4401700</td>
<td align="left">37,495</td>
</tr>
<tr class="even">
<td align="right">5010100</td>
<td align="left">13,073</td>
</tr>
<tr class="odd">
<td align="right">5010200</td>
<td align="left">13,779</td>
</tr>
<tr class="even">
<td align="right">5010400</td>
<td align="left">12,940</td>
</tr>
<tr class="odd">
<td align="right">5010800</td>
<td align="left">13,491</td>
</tr>
<tr class="even">
<td align="right">5011100</td>
<td align="left">14,085</td>
</tr>
<tr class="odd">
<td align="right">5011200</td>
<td align="left">14,926</td>
</tr>
<tr class="even">
<td align="right">5011300</td>
<td align="left">11,552</td>
</tr>
<tr class="odd">
<td align="right">5011500</td>
<td align="left">12,574</td>
</tr>
<tr class="even">
<td align="right">5011900</td>
<td align="left">14,286</td>
</tr>
<tr class="odd">
<td align="right">5012000</td>
<td align="left">7,884</td>
</tr>
<tr class="even">
<td align="right">5012200</td>
<td align="left">14,615</td>
</tr>
<tr class="odd">
<td align="right">5012300</td>
<td align="left">17,550</td>
</tr>
<tr class="even">
<td align="right">5012600</td>
<td align="left">18,573</td>
</tr>
<tr class="odd">
<td align="right">5012700</td>
<td align="left">17,692</td>
</tr>
<tr class="even">
<td align="right">5013100</td>
<td align="left">14,767</td>
</tr>
<tr class="odd">
<td align="right">5013600</td>
<td align="left">12,696</td>
</tr>
<tr class="even">
<td align="right">5013700</td>
<td align="left">18,741</td>
</tr>
<tr class="odd">
<td align="right">5014200</td>
<td align="left">18,463</td>
</tr>
<tr class="even">
<td align="right">5015800</td>
<td align="left">13,900</td>
</tr>
<tr class="odd">
<td align="right">5016700</td>
<td align="left">14,902</td>
</tr>
<tr class="even">
<td align="right">5017600</td>
<td align="left">30,305</td>
</tr>
<tr class="odd">
<td align="right">5018400</td>
<td align="left">13,320</td>
</tr>
<tr class="even">
<td align="right">5018700</td>
<td align="left">12,750</td>
</tr>
<tr class="odd">
<td align="right">5018900</td>
<td align="left">16,204</td>
</tr>
<tr class="even">
<td align="right">5021800</td>
<td align="left">13,472</td>
</tr>
<tr class="odd">
<td align="right">5021900</td>
<td align="left">33,230</td>
</tr>
<tr class="even">
<td align="right">5022000</td>
<td align="left">9,947</td>
</tr>
<tr class="odd">
<td align="right">5022600</td>
<td align="left">10,678</td>
</tr>
<tr class="even">
<td align="right">5022800</td>
<td align="left">13,961</td>
</tr>
<tr class="odd">
<td align="right">7011600</td>
<td align="left">13,529</td>
</tr>
<tr class="even">
<td align="right">7012200</td>
<td align="left">19,972</td>
</tr>
<tr class="odd">
<td align="right">7013600</td>
<td align="left">12,690</td>
</tr>
<tr class="even">
<td align="right">7014000</td>
<td align="left">17,095</td>
</tr>
<tr class="odd">
<td align="right">7014900</td>
<td align="left">11,052</td>
</tr>
<tr class="even">
<td align="right">7015400</td>
<td align="left">34,355</td>
</tr>
<tr class="odd">
<td align="right">7015800</td>
<td align="left">12,550</td>
</tr>
<tr class="even">
<td align="right">7015900</td>
<td align="left">19,024</td>
</tr>
<tr class="odd">
<td align="right">7016200</td>
<td align="left">16,727</td>
</tr>
<tr class="even">
<td align="right">7016400</td>
<td align="left">9,342</td>
</tr>
<tr class="odd">
<td align="right">7017800</td>
<td align="left">21,409</td>
</tr>
<tr class="even">
<td align="right">7018400</td>
<td align="left">10,093</td>
</tr>
<tr class="odd">
<td align="right">7018500</td>
<td align="left">20,197</td>
</tr>
<tr class="even">
<td align="right">7018600</td>
<td align="left">20,917</td>
</tr>
<tr class="odd">
<td align="right">7019200</td>
<td align="left">15,841</td>
</tr>
<tr class="even">
<td align="right">7019300</td>
<td align="left">16,760</td>
</tr>
<tr class="odd">
<td align="right">7019400</td>
<td align="left">9,734</td>
</tr>
<tr class="even">
<td align="right">7019500</td>
<td align="left">20,318</td>
</tr>
<tr class="odd">
<td align="right">7019800</td>
<td align="left">17,939</td>
</tr>
<tr class="even">
<td align="right">7042100</td>
<td align="left">15,697</td>
</tr>
<tr class="odd">
<td align="right">7043300</td>
<td align="left">13,305</td>
</tr>
<tr class="even">
<td align="right">7043900</td>
<td align="left">13,670</td>
</tr>
<tr class="odd">
<td align="right">7044000</td>
<td align="left">20,965</td>
</tr>
<tr class="even">
<td align="right">8011100</td>
<td align="left">18,913</td>
</tr>
<tr class="odd">
<td align="right">8011200</td>
<td align="left">20,239</td>
</tr>
<tr class="even">
<td align="right">8012300</td>
<td align="left">18,158</td>
</tr>
<tr class="odd">
<td align="right">8012800</td>
<td align="left">12,301</td>
</tr>
<tr class="even">
<td align="right">8013600</td>
<td align="left">18,177</td>
</tr>
<tr class="odd">
<td align="right">8013900</td>
<td align="left">15,181</td>
</tr>
<tr class="even">
<td align="right">8014200</td>
<td align="left">17,562</td>
</tr>
<tr class="odd">
<td align="right">8014900</td>
<td align="left">22,011</td>
</tr>
<tr class="even">
<td align="right">8015200</td>
<td align="left">12,550</td>
</tr>
<tr class="odd">
<td align="right">8016300</td>
<td align="left">13,535</td>
</tr>
<tr class="even">
<td align="right">8017000</td>
<td align="left">13,387</td>
</tr>
<tr class="odd">
<td align="right">8017300</td>
<td align="left">20,157</td>
</tr>
<tr class="even">
<td align="right">8018400</td>
<td align="left">19,116</td>
</tr>
<tr class="odd">
<td align="right">8018500</td>
<td align="left">13,344</td>
</tr>
<tr class="even">
<td align="right">8021400</td>
<td align="left">12,763</td>
</tr>
<tr class="odd">
<td align="right">8021900</td>
<td align="left">17,850</td>
</tr>
<tr class="even">
<td align="right">8022500</td>
<td align="left">14,635</td>
</tr>
<tr class="odd">
<td align="right">8023000</td>
<td align="left">20,363</td>
</tr>
<tr class="even">
<td align="right">8023100</td>
<td align="left">19,951</td>
</tr>
</tbody>
</table>

</div>
</div>
<div id="ranking-qes-according-to-occurrence-at-baseline" class="section level2">
<h2>Ranking QES according to occurrence at baseline</h2>
<p><img src="COPD_Analysis_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Both bar charts above depicts QES frequencies at both baseline and follow up. Excluding the No emphysema (NE), the <em>Diffuse</em> QES appears more often while <em>Vanishing Lung</em> QES appears the least.</p>
</div>
<div id="the-sankey-diagram---qes-transitions" class="section level2">
<h2>The Sankey Diagram - QES Transitions</h2>
<p>In this plot and because of clarity reasons, I ignored the transition from No Emphysema at baseline to No Emohysema at follow up and only included transitions from either NE or any QES (Baseline) to any of the QES at follow up.</p>
<div id="htmlwidget-f37610d900f8c514719e" style="width:672px;height:480px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-f37610d900f8c514719e">{"x":{"links":{"source":[0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6],"target":[7,8,9,10,11,12,7,8,9,10,11,12,7,8,9,10,11,12,7,8,9,10,11,12,7,8,9,10,11,12,7,8,9,10,11,12,7,8,9,10,11,12],"value":[30,14724,51960,74111,42498,25493,7549,1545,57,15,13,24,6369,61096,6169,2319,943,3627,760,30522,121251,21694,1955,1366,52,14499,34015,48456,8377,4253,19,4945,4113,13346,14098,4513,19,9464,991,3153,3994,17811]},"nodes":{"name":["NE","Vanishing","Apical","Diffuse","Senile","oCPFE","rCPFE","Vanishing ","Apical ","Diffuse ","Senile ","oCPFE ","rCPFE "],"group":["NE","Vanishing","Apical","Diffuse","Senile","oCPFE","rCPFE","Vanishing ","Apical ","Diffuse ","Senile ","oCPFE ","rCPFE "]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":13,"fontFamily":null,"nodeWidth":40,"nodePadding":20,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":false}},"evals":[],"jsHooks":[]}</script>
<p>The <strong>Sankey Diagram</strong> above showcases how QES at baseline transitioned to follow up. The thicker the line the more frequent transitions appearing in the data.</p>

</div>
<div id="plotting-the-3d-coordinates" class="section level2">
<h2>Plotting the 3D coordinates</h2>
<p>Below, I explore a 3D plot of randomly selected ID numbers using the x,y,z pixel coordinates in the dataset. Please note that the colors merely represent different locations of the lung measured for this particular patient.</p>
<p><img src="COPD_Analysis_files/figure-html/one_id-1.png" width="672" /></p>
<p>The 3D plots explores the patient’s (2 randomly selected patients) emphysema severity. The CT scan shows these patients have a wide ranging emphysema subtype all over their lungs.</p>
</div>
</div>
<div id="model-building---studying-association" class="section level1">
<h1>Model Building - Studying Association</h1>
<div id="modeling-qes" class="section level2">
<h2>Modeling QES</h2>
<p>The dataset below was used in model building. It was constructed from counting the frequencies of each QES transitions from baseline to follow up. By default, the <strong>Apical</strong> is considered as the reference QES category, thus all model interpretations are based on it.</p>
<p><strong>Table 4: Frequencies of Transitions Between QES</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">qes_baseline</th>
<th align="left">Diffuse</th>
<th align="left">NE</th>
<th align="left">Senile</th>
<th align="left">Apical</th>
<th align="left">rCPFE</th>
<th align="left">oCPFE</th>
<th align="left">Vanishing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NE</td>
<td align="left">51,960</td>
<td align="left">2,146,336</td>
<td align="left">74,111</td>
<td align="left">14,724</td>
<td align="left">25,493</td>
<td align="left">42,498</td>
<td align="left">30</td>
</tr>
<tr class="even">
<td align="left">Diffuse</td>
<td align="left">121,251</td>
<td align="left">0</td>
<td align="left">21,694</td>
<td align="left">30,522</td>
<td align="left">1,366</td>
<td align="left">1,955</td>
<td align="left">760</td>
</tr>
<tr class="odd">
<td align="left">Apical</td>
<td align="left">6,169</td>
<td align="left">0</td>
<td align="left">2,319</td>
<td align="left">61,096</td>
<td align="left">3,627</td>
<td align="left">943</td>
<td align="left">6,369</td>
</tr>
<tr class="even">
<td align="left">Senile</td>
<td align="left">34,015</td>
<td align="left">0</td>
<td align="left">48,456</td>
<td align="left">14,499</td>
<td align="left">4,253</td>
<td align="left">8,377</td>
<td align="left">52</td>
</tr>
<tr class="odd">
<td align="left">rCPFE</td>
<td align="left">991</td>
<td align="left">0</td>
<td align="left">3,153</td>
<td align="left">9,464</td>
<td align="left">17,811</td>
<td align="left">3,994</td>
<td align="left">19</td>
</tr>
<tr class="even">
<td align="left">oCPFE</td>
<td align="left">4,113</td>
<td align="left">0</td>
<td align="left">13,346</td>
<td align="left">4,945</td>
<td align="left">4,513</td>
<td align="left">14,098</td>
<td align="left">19</td>
</tr>
<tr class="odd">
<td align="left">Vanishing</td>
<td align="left">57</td>
<td align="left">0</td>
<td align="left">15</td>
<td align="left">1,545</td>
<td align="left">24</td>
<td align="left">13</td>
<td align="left">7,549</td>
</tr>
</tbody>
</table>
<div id="multinomial-log-linear-model-for-qes" class="section level3">
<h3>Multinomial Log-linear Model for QES</h3>
<p>Assuming observations are independent, meaning correlation between individual measures per patient is irrelevant in the study, we can model <strong>QES at follow up</strong> (response variable) using the Nominal regression model (from the generalized linear model) that looks at nominal responses (where no order is assigned), which is what our response is.</p>
<ul>
<li>The code below also builds the nominal regression model for the association between QES at baseline and QES at follow up. Reference categories for the model will be <strong>Diffuse</strong> for both the QES at baseline variables and QES at follow up.</li>
</ul>
<p><strong>Note that any of the categories can be used as the reference category. Regardless of the chosen reference category, the model will fit equally well and achieve the same likelihood.</strong></p>
<p>This model is flawed in that it does not treat this dataset as longitidinal data. It considers each observation as independent, therefore does not account for within-subject correlations that might be present due to multiple measures taken. It merely studies QES transitions from baseline to follow up.</p>
<p><strong>Table 5: Model estimates and (Standard Errors) for QES are shown in the table below</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Response</th>
<th align="left">intercept</th>
<th align="left">bas_NE</th>
<th align="left">bas_senile</th>
<th align="left">bas_apical</th>
<th align="left">bas_rcpfe</th>
<th align="left">bas_ocpfe</th>
<th align="left">bas_vanishing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">qes_NE</td>
<td align="left">-8.91 (0.25)</td>
<td align="left">12.63 (0.25)</td>
<td align="left">-0.05 (0.54)</td>
<td align="left">-4.54 (10.64)</td>
<td align="left">0.2 (2.45)</td>
<td align="left">-2.61 (4.99)</td>
<td align="left">-4.26 (0)</td>
</tr>
<tr class="even">
<td align="left">qes_senile</td>
<td align="left">-1.72 (0.01)</td>
<td align="left">2.07 (0.01)</td>
<td align="left">2.08 (0.01)</td>
<td align="left">0.72 (0.03)</td>
<td align="left">2.84 (0.04)</td>
<td align="left">2.91 (0.02)</td>
<td align="left">0.54 (0.28)</td>
</tr>
<tr class="odd">
<td align="left">qes_apical</td>
<td align="left">-1.38 (0.01)</td>
<td align="left">0.12 (0.01)</td>
<td align="left">0.53 (0.01)</td>
<td align="left">3.67 (0.01)</td>
<td align="left">3.61 (0.03)</td>
<td align="left">1.59 (0.02)</td>
<td align="left">4.71 (0.14)</td>
</tr>
<tr class="even">
<td align="left">qes_rcpfe</td>
<td align="left">-4.49 (0.03)</td>
<td align="left">3.77 (0.03)</td>
<td align="left">2.4 (0.03)</td>
<td align="left">3.97 (0.03)</td>
<td align="left">7.34 (0.04)</td>
<td align="left">4.59 (0.03)</td>
<td align="left">3.57 (0.26)</td>
</tr>
<tr class="odd">
<td align="left">qes_ocpfe</td>
<td align="left">-4.13 (0.02)</td>
<td align="left">3.93 (0.02)</td>
<td align="left">2.72 (0.03)</td>
<td align="left">2.3 (0.04)</td>
<td align="left">5.5 (0.04)</td>
<td align="left">5.36 (0.03)</td>
<td align="left">2.5 (0.34)</td>
</tr>
<tr class="even">
<td align="left">qes_vanishing</td>
<td align="left">-4.95 (0.03)</td>
<td align="left">-27.4 (0)</td>
<td align="left">-1.39 (0.13)</td>
<td align="left">4.98 (0.04)</td>
<td align="left">-1.04 (0.63)</td>
<td align="left">-3.21 (0.93)</td>
<td align="left">9.92 (0.14)</td>
</tr>
</tbody>
</table>
<p><strong>QES Model Interpretations:</strong></p>
<p>We have six indicator/dummy variables all with <em>Diffuse</em> as their reference category:</p>
<p>X1: No Emphysema at baseline</p>
<p>X2: Senile QES at baseline</p>
<p>X3: Apical QES at baseline</p>
<p>X4: rCPFE QES at baseline</p>
<p>X5: oCPFE QES at baseline</p>
<p>X6: Vanishing Lung QES at baseline</p>
<p><strong>Comparing the NE Vs Diffuse QES at follow up:</strong></p>
<ul>
<li><p>The odds ratio of NE is 3.066053210^{5} (95% CI: [1.886983710^{5}, 4.981856710^{5}]) in patients with No Emphysema at baseline.</p></li>
<li><p>The odds ratio of NE is 0.95 (95% CI: [0.33, 2.73]) in patients with Senile at baseline.</p></li>
<li><p>The odds ratio of NE is 0.01 (95% CI: [0, 1.206017810^{7}]) in patients with Apical at baseline.</p></li>
<li><p>The odds ratio of NE is 1.23 (95% CI: [0.01, 148.25]) in patients with rCPFE at baseline.</p></li>
<li><p>The odds ratio of NE is 0.07 (95% CI: [0, 1283.95]) in patients with oCPFE at baseline.</p></li>
<li><p>The odds ratio of NE is 0.01 (95% CI: [0.01, 0.01]) in patients with Vanishing Lungs at baseline.</p></li>
</ul>
<p><strong>Comparing the Senile Vs Diffuse QES at follow up:</strong></p>
<ul>
<li><p>The odds ratio of senile is 7.96 (95% CI: [7.82, 8.11]) in patients with No Emphysema at baseline.</p></li>
<li><p>The odds ratio of senile is 7.96 (95% CI: [7.81, 8.13]) in patients with Senile at baseline.</p></li>
<li><p>The odds ratio of senile is 2.05 (95% CI: [1.95, 2.16]) in patients with Apical at baseline.</p></li>
<li><p>The odds ratio of senile is 17.09 (95% CI: [15.9, 18.37]) in patients with rCPFE at baseline.</p></li>
<li><p>The odds ratio of senile is 18.3 (95% CI: [17.62, 19.01]) in patients with oCPFE at baseline.</p></li>
<li><p>The odds ratio of senile is 1.71 (95% CI: [0.98, 2.98]) in patients with Vanishing Lungs at baseline.</p></li>
</ul>
<p><strong>Comparing the Apical Vs Diffuse QES at follow up:</strong></p>
<ul>
<li><p>The odds ratio of Apical is 1.13 (95% CI: [1.11, 1.16]) in patients with No Emphysema at baseline.</p></li>
<li><p>The odds ratio of Apical is 1.7 (95% CI: [1.66, 1.74]) in patients with Senile at baseline.</p></li>
<li><p>The odds ratio of Apical is 39.28 (95% CI: [38.15, 40.43]) in patients with Apical at baseline.</p></li>
<li><p>The odds ratio of Apical is 37.07 (95% CI: [34.71, 39.58]) in patients with rCPFE at baseline.</p></li>
<li><p>The odds ratio of Apical is 4.89 (95% CI: [4.68, 5.11]) in patients with oCPFE at baseline.</p></li>
<li><p>The odds ratio of Apical is 111.43 (95% CI: [84.73, 146.55]) in patients with Vanishing Lungs at baseline.</p></li>
</ul>
<p><strong>Comparing the rCPFE Vs Diffuse QES at follow up:</strong></p>
<ul>
<li><p>The odds ratio of rCPFE is 43.43 (95% CI: [41.09, 45.91]) in patients with No Emphysema at baseline.</p></li>
<li><p>The odds ratio of rCPFE is 11.06 (95% CI: [10.39, 11.77]) in patients with Senile at baseline.</p></li>
<li><p>The odds ratio of rCPFE is 52.94 (95% CI: [49.5, 56.62]) in patients with Apical at baseline.</p></li>
<li><p>The odds ratio of rCPFE is 1540.63 (95% CI: [1418.44, 1673.34]) in patients with rCPFE at baseline.</p></li>
<li><p>The odds ratio of rCPFE is 98.83 (95% CI: [92.32, 105.79]) in patients with oCPFE at baseline.</p></li>
<li><p>The odds ratio of rCPFE is 35.48 (95% CI: [21.38, 58.89]) in patients with Vanishing Lungs at baseline.</p></li>
</ul>
<p><strong>Comparing the oCPFE Vs Diffuse QES at follow up:</strong></p>
<ul>
<li><p>The odds ratio of oCPFE is 51.01 (95% CI: [48.69, 53.44]) in patients with No Emphysema at baseline.</p></li>
<li><p>The odds ratio of oCPFE is 15.16 (95% CI: [14.41, 15.95]) in patients with Senile at baseline.</p></li>
<li><p>The odds ratio of oCPFE is 9.94 (95% CI: [9.17, 10.78]) in patients with Apical at baseline.</p></li>
<li><p>The odds ratio of oCPFE is 244.03 (95% CI: [224.83, 264.88]) in patients with rCPFE at baseline.</p></li>
<li><p>The odds ratio of oCPFE is 213.27 (95% CI: [201.5, 225.72]) in patients with oCPFE at baseline.</p></li>
<li><p>The odds ratio of oCPFE is 12.21 (95% CI: [6.28, 23.76]) in patients with Vanishing Lungs at baseline.</p></li>
</ul>
<p><strong>Comparing the Vanishing Lung Vs Diffuse QES at follow up:</strong></p>
<ul>
<li><p>The odds ratio of Vanishing is 0 (95% CI: [0, 0]) in patients with No Emphysema at baseline.</p></li>
<li><p>The odds ratio of Vanishing is 0.25 (95% CI: [0.19, 0.32]) in patients with Senile at baseline.</p></li>
<li><p>The odds ratio of Vanishing is 144.91 (95% CI: [134.32, 156.33]) in patients with Apical at baseline.</p></li>
<li><p>The odds ratio of Vanishing is 0.35 (95% CI: [0.1, 1.21]) in patients with rCPFE at baseline.</p></li>
<li><p>The odds ratio of Vanishing is 0.04 (95% CI: [0.01, 0.25]) in patients with oCPFE at baseline.</p></li>
<li><p>The odds ratio of Vanishing is 2.02839210^{4} (95% CI: [1.53595910^{4}, 2.67869910^{4}]) in patients with Vanishing Lungs at baseline.</p></li>
</ul>
</div>
</div>
<div id="modeling-spatially-informed-lung-texture-patterns-sltp" class="section level2">
<h2>Modeling Spatially-Informed Lung Texture Patterns (sLTP)</h2>
<p>Next, I will count sLTP frequencies and therefore build a dataframe for each sLTP at baseline and how many times and to which sLTP it was converted to at follow up. The newly created dataframe will help us build a multinomial nominal model for sLTPs.</p>

<p><strong>Table 6: Frequencies of Transitions Between sLTPs</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">sltp_bas</th>
<th align="left">-1</th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
<th align="left">9</th>
<th align="left">10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">-1</td>
<td align="left">2,146,336</td>
<td align="left">0</td>
<td align="left">30</td>
<td align="left">608</td>
<td align="left">10,209</td>
<td align="left">3,121</td>
<td align="left">41,751</td>
<td align="left">74,111</td>
<td align="left">42,498</td>
<td align="left">10,995</td>
<td align="left">25,493</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0</td>
<td align="left">1,391</td>
<td align="left">393</td>
<td align="left">18</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">3</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">0</td>
<td align="left">427</td>
<td align="left">5,338</td>
<td align="left">1,264</td>
<td align="left">44</td>
<td align="left">118</td>
<td align="left">13</td>
<td align="left">15</td>
<td align="left">12</td>
<td align="left">141</td>
<td align="left">23</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">0</td>
<td align="left">40</td>
<td align="left">4,757</td>
<td align="left">10,843</td>
<td align="left">561</td>
<td align="left">1,640</td>
<td align="left">182</td>
<td align="left">99</td>
<td align="left">47</td>
<td align="left">903</td>
<td align="left">161</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">0</td>
<td align="left">7</td>
<td align="left">519</td>
<td align="left">4,406</td>
<td align="left">35,464</td>
<td align="left">6,424</td>
<td align="left">17,699</td>
<td align="left">1,946</td>
<td align="left">285</td>
<td align="left">577</td>
<td align="left">185</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">0</td>
<td align="left">11</td>
<td align="left">1,344</td>
<td align="left">8,988</td>
<td align="left">1,644</td>
<td align="left">8,166</td>
<td align="left">1,080</td>
<td align="left">356</td>
<td align="left">149</td>
<td align="left">1,932</td>
<td align="left">285</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">234</td>
<td align="left">3,519</td>
<td align="left">19,492</td>
<td align="left">11,058</td>
<td align="left">48,596</td>
<td align="left">19,748</td>
<td align="left">1,670</td>
<td align="left">4,538</td>
<td align="left">1,181</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">52</td>
<td align="left">843</td>
<td align="left">5,951</td>
<td align="left">4,946</td>
<td align="left">28,064</td>
<td align="left">48,456</td>
<td align="left">8,377</td>
<td align="left">8,710</td>
<td align="left">4,253</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">19</td>
<td align="left">166</td>
<td align="left">737</td>
<td align="left">696</td>
<td align="left">3,376</td>
<td align="left">13,346</td>
<td align="left">14,098</td>
<td align="left">4,083</td>
<td align="left">4,513</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">217</td>
<td align="left">5,780</td>
<td align="left">556</td>
<td align="left">6,717</td>
<td align="left">2,146</td>
<td align="left">1,864</td>
<td align="left">747</td>
<td align="left">16,127</td>
<td align="left">3,181</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">19</td>
<td align="left">488</td>
<td align="left">92</td>
<td align="left">690</td>
<td align="left">899</td>
<td align="left">3,153</td>
<td align="left">3,994</td>
<td align="left">8,286</td>
<td align="left">17,811</td>
</tr>
</tbody>
</table>
<div id="multinomial-log-linear-model-for-sltp" class="section level3">
<h3>Multinomial Log-linear Model for sLTP</h3>
<p>The multinomial nominal model is built by first defining the response variable (consisted of 10 categories) where sLTP 1 will be considered as reference.</p>
<p>This model is flawed in that it does not treat this dataset as longitidinal data. It considers each observation as independent, therefore does not account for within-subject correlations that might be present due to multiple measures taken. It merely studies sLTP transitions from baseline to follow up.</p>
<p><strong>Table 7: Model estimates for sLTP are shown in the table below</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Response</th>
<th align="right">intercept</th>
<th align="right">bas_1</th>
<th align="right">bas_2</th>
<th align="right">bas_3</th>
<th align="right">bas_4</th>
<th align="right">bas_5</th>
<th align="right">bas_6</th>
<th align="right">bas_7</th>
<th align="right">bas_8</th>
<th align="right">bas_9</th>
<th align="right">bas_10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sltp_1</td>
<td align="right">-74.99</td>
<td align="right">131.28</td>
<td align="right">82.09</td>
<td align="right">81.82</td>
<td align="right">16.63</td>
<td align="right">39.15</td>
<td align="right">-17.44</td>
<td align="right">-17.38</td>
<td align="right">-6.50</td>
<td align="right">-5.92</td>
<td align="right">-5.61</td>
</tr>
<tr class="even">
<td align="left">sltp_2</td>
<td align="right">-11.47</td>
<td align="right">66.44</td>
<td align="right">21.32</td>
<td align="right">24.33</td>
<td align="right">8.38</td>
<td align="right">17.11</td>
<td align="right">9.33</td>
<td align="right">4.85</td>
<td align="right">-13.32</td>
<td align="right">19.96</td>
<td align="right">-0.27</td>
</tr>
<tr class="odd">
<td align="left">sltp_3</td>
<td align="right">-13.09</td>
<td align="right">66.26</td>
<td align="right">21.67</td>
<td align="right">26.92</td>
<td align="right">13.98</td>
<td align="right">21.12</td>
<td align="right">12.80</td>
<td align="right">11.28</td>
<td align="right">7.68</td>
<td align="right">23.64</td>
<td align="right">13.51</td>
</tr>
<tr class="even">
<td align="left">sltp_4</td>
<td align="right">-5.14</td>
<td align="right">-4.96</td>
<td align="right">8.36</td>
<td align="right">15.93</td>
<td align="right">8.14</td>
<td align="right">11.24</td>
<td align="right">6.66</td>
<td align="right">5.62</td>
<td align="right">3.13</td>
<td align="right">13.53</td>
<td align="right">6.90</td>
</tr>
<tr class="odd">
<td align="left">sltp_5</td>
<td align="right">-6.80</td>
<td align="right">1.00</td>
<td align="right">-7.37</td>
<td align="right">18.68</td>
<td align="right">8.17</td>
<td align="right">14.54</td>
<td align="right">7.52</td>
<td align="right">7.62</td>
<td align="right">5.31</td>
<td align="right">17.56</td>
<td align="right">7.58</td>
</tr>
<tr class="even">
<td align="left">sltp_6</td>
<td align="right">-3.94</td>
<td align="right">-18.35</td>
<td align="right">-4.19</td>
<td align="right">15.45</td>
<td align="right">6.20</td>
<td align="right">10.11</td>
<td align="right">6.37</td>
<td align="right">6.00</td>
<td align="right">3.86</td>
<td align="right">14.20</td>
<td align="right">5.32</td>
</tr>
<tr class="odd">
<td align="left">sltp_7</td>
<td align="right">-3.37</td>
<td align="right">-37.22</td>
<td align="right">-17.40</td>
<td align="right">11.47</td>
<td align="right">3.30</td>
<td align="right">8.16</td>
<td align="right">4.84</td>
<td align="right">6.01</td>
<td align="right">4.75</td>
<td align="right">12.60</td>
<td align="right">5.93</td>
</tr>
<tr class="even">
<td align="left">sltp_8</td>
<td align="right">-3.82</td>
<td align="right">-21.04</td>
<td align="right">6.10</td>
<td align="right">13.83</td>
<td align="right">2.31</td>
<td align="right">6.26</td>
<td align="right">2.93</td>
<td align="right">4.65</td>
<td align="right">5.08</td>
<td align="right">12.88</td>
<td align="right">6.45</td>
</tr>
<tr class="odd">
<td align="left">sltp_9</td>
<td align="right">-4.78</td>
<td align="right">51.59</td>
<td align="right">12.52</td>
<td align="right">15.80</td>
<td align="right">3.03</td>
<td align="right">11.37</td>
<td align="right">5.29</td>
<td align="right">5.81</td>
<td align="right">4.82</td>
<td align="right">16.31</td>
<td align="right">7.99</td>
</tr>
<tr class="even">
<td align="left">sltp_10</td>
<td align="right">-4.18</td>
<td align="right">28.74</td>
<td align="right">10.18</td>
<td align="right">11.45</td>
<td align="right">2.95</td>
<td align="right">3.82</td>
<td align="right">2.98</td>
<td align="right">4.52</td>
<td align="right">4.68</td>
<td align="right">13.56</td>
<td align="right">8.23</td>
</tr>
</tbody>
</table>
<p><strong>sLTP Model Interpretation:</strong></p>
<p>Below is the example interpretation of model estimates for the response sLTP 1. Similar interpretations can be done for the other 10 sLTPs in the table above.</p>
<p><strong>Comparing the sLTP 1 Vs sLTP -1 at follow up:</strong></p>
<ul>
<li><p>The odds ratio of sLTP 1 is 1.032125410^{57} in patients with sLTP 1 at baseline.</p></li>
<li><p>The odds ratio of sLTP 1 is 4.490344710^{35} in patients with sLTP 2 at baseline.</p></li>
<li><p>The odds ratio of sLTP 1 is 3.407407410^{35} in patients with sLTP 3 at baseline.</p></li>
<li><p>The odds ratio of sLTP 1 is 1.665621410^{7} in patients with sLTP 4 at baseline.</p></li>
<li><p>The odds ratio of sLTP 1 is 1.002546510^{17} in patients with sLTP 5 at baseline.</p></li>
<li><p>The odds ratio of sLTP 1 is 0 in patients with sLTP 6 at baseline.</p></li>
<li><p>The odds ratio of sLTP 1 is 0 in patients with sLTP 7 at baseline.</p></li>
<li><p>The odds ratio of sLTP 1 is 0 in patients with sLTP 8 at baseline.</p></li>
<li><p>The odds ratio of sLTP 1 is 0 in patients with sLTP 9 at baseline.</p></li>
<li><p>The odds ratio of sLTP 1 is 0 in patients with sLTP 10 at baseline.</p></li>
</ul>
</div>
</div>
</div>
<div id="model-building---studying-prediction-of-qes" class="section level1">
<h1>Model Building - Studying Prediction of QES</h1>
<div id="linear-discriminant-analysis-p-1" class="section level2">
<h2>Linear Discriminant Analysis (P = 1)</h2>
<p>The Linear Discriminant Analysis (LDA) algorithm starts by finding directions that maximizes the separation between classes, then use these directions to predict the class of individuals. These directions, called linear discriminants, are a linear combinations of predictor variables.</p>
<p>LDA generates posterior probabilities that a certain observations belongs to a certain QES categories given the predictor value for that observation. LDA assumes that observations within each QES category come from a <strong>normal distribution</strong> with a category-specific mean vector and a <strong>common covariance matrix for all categories</strong>.</p>
<pre><code>##       score
## 1 0.8973472</code></pre>
<p><strong>Table 8: Model Output of Count of correctly classified Vs misclassfied Responses</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Observed</th>
<th align="left">Predicted</th>
<th align="left">Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NE</td>
<td align="left">NE</td>
<td align="left">456,149</td>
</tr>
<tr class="even">
<td align="left">Diffuse</td>
<td align="left">Diffuse</td>
<td align="left">26,683</td>
</tr>
<tr class="odd">
<td align="left">Apical</td>
<td align="left">Apical</td>
<td align="left">13,458</td>
</tr>
<tr class="even">
<td align="left">Diffuse</td>
<td align="left">NE</td>
<td align="left">9,755</td>
</tr>
<tr class="odd">
<td align="left">Apical</td>
<td align="left">Diffuse</td>
<td align="left">8,808</td>
</tr>
<tr class="even">
<td align="left">Diffuse</td>
<td align="left">Senile</td>
<td align="left">7,622</td>
</tr>
<tr class="odd">
<td align="left">Senile</td>
<td align="left">NE</td>
<td align="left">7,344</td>
</tr>
<tr class="even">
<td align="left">Apical</td>
<td align="left">NE</td>
<td align="left">5,453</td>
</tr>
<tr class="odd">
<td align="left">Senile</td>
<td align="left">Senile</td>
<td align="left">5,431</td>
</tr>
<tr class="even">
<td align="left">Apical</td>
<td align="left">Senile</td>
<td align="left">3,107</td>
</tr>
<tr class="odd">
<td align="left">rCPFE</td>
<td align="left">NE</td>
<td align="left">2,270</td>
</tr>
<tr class="even">
<td align="left">oCPFE</td>
<td align="left">NE</td>
<td align="left">2,247</td>
</tr>
<tr class="odd">
<td align="left">Senile</td>
<td align="left">Diffuse</td>
<td align="left">2,144</td>
</tr>
<tr class="even">
<td align="left">Vanishing</td>
<td align="left">Apical</td>
<td align="left">1,458</td>
</tr>
<tr class="odd">
<td align="left">Diffuse</td>
<td align="left">Apical</td>
<td align="left">1,201</td>
</tr>
<tr class="even">
<td align="left">oCPFE</td>
<td align="left">oCPFE</td>
<td align="left">1,201</td>
</tr>
<tr class="odd">
<td align="left">Apical</td>
<td align="left">oCPFE</td>
<td align="left">1,163</td>
</tr>
<tr class="even">
<td align="left">oCPFE</td>
<td align="left">Senile</td>
<td align="left">926</td>
</tr>
<tr class="odd">
<td align="left">Senile</td>
<td align="left">oCPFE</td>
<td align="left">844</td>
</tr>
<tr class="even">
<td align="left">rCPFE</td>
<td align="left">rCPFE</td>
<td align="left">762</td>
</tr>
<tr class="odd">
<td align="left">Apical</td>
<td align="left">rCPFE</td>
<td align="left">757</td>
</tr>
<tr class="even">
<td align="left">rCPFE</td>
<td align="left">oCPFE</td>
<td align="left">529</td>
</tr>
<tr class="odd">
<td align="left">Vanishing</td>
<td align="left">Vanishing</td>
<td align="left">364</td>
</tr>
<tr class="even">
<td align="left">oCPFE</td>
<td align="left">Diffuse</td>
<td align="left">305</td>
</tr>
<tr class="odd">
<td align="left">rCPFE</td>
<td align="left">Senile</td>
<td align="left">287</td>
</tr>
<tr class="even">
<td align="left">Senile</td>
<td align="left">Apical</td>
<td align="left">284</td>
</tr>
<tr class="odd">
<td align="left">Diffuse</td>
<td align="left">oCPFE</td>
<td align="left">218</td>
</tr>
<tr class="even">
<td align="left">rCPFE</td>
<td align="left">Apical</td>
<td align="left">199</td>
</tr>
<tr class="odd">
<td align="left">rCPFE</td>
<td align="left">Diffuse</td>
<td align="left">194</td>
</tr>
<tr class="even">
<td align="left">Apical</td>
<td align="left">Vanishing</td>
<td align="left">171</td>
</tr>
<tr class="odd">
<td align="left">oCPFE</td>
<td align="left">Apical</td>
<td align="left">109</td>
</tr>
<tr class="even">
<td align="left">Senile</td>
<td align="left">rCPFE</td>
<td align="left">83</td>
</tr>
<tr class="odd">
<td align="left">Vanishing</td>
<td align="left">Diffuse</td>
<td align="left">82</td>
</tr>
<tr class="even">
<td align="left">oCPFE</td>
<td align="left">rCPFE</td>
<td align="left">72</td>
</tr>
<tr class="odd">
<td align="left">Diffuse</td>
<td align="left">rCPFE</td>
<td align="left">11</td>
</tr>
<tr class="even">
<td align="left">Vanishing</td>
<td align="left">NE</td>
<td align="left">6</td>
</tr>
<tr class="odd">
<td align="left">Senile</td>
<td align="left">Vanishing</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">Diffuse</td>
<td align="left">Vanishing</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td align="left">rCPFE</td>
<td align="left">Vanishing</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">oCPFE</td>
<td align="left">Vanishing</td>
<td align="left">1</td>
</tr>
</tbody>
</table>
</div>
<div id="rnn-lstm-sequence-to-sequence" class="section level2">
<h2>RNN-LSTM: Sequence to sequence</h2>
<p>A portion of this section, if not all, will be done in Python where I will look at the Deep Learning Technique called Recurrent Neural Network (RNN-LSTM) for Multiclass classification with imbalanced dataset since the 6 QES categories at baseline or follow up are not uniformly distributed throughout the dataset.</p>
<p>Before building the RNN model, I will need to fix the problem of imbalanced data that occurs in my dataset.</p>
<p><strong>Problem:</strong> The two histograms above depicts the problem of an imbalanced dataset. Imbalanced data is defined as a classification problem where the number of observations per class (IDNO in this instance) is not equally distributed. In this case we have a large amount of data/observations for one class (IDNO - referred to as the majority class), and much fewer observations for another class. Specifically, we have some QES which appear more times than others. For example, in the response QES at follow up variable, we have a certain, unnamed, type of QES appearing ~76 times while another only appears ~5 times. To solve this, I will use a very popular technique called <strong>Synthetic Minority Oversampling Technique or SMOTE</strong> which looks at increasing the number of cases in the dataset in a balanced way. The SMOTE model works by generating new instances from existing minority cases that is supplied as input.</p>
<p><strong>Question - Week 2</strong></p>
<ol style="list-style-type: decimal">
<li><p>I am wondering if time is a big factor in modeling QES at follow up. This dataset does not seem like the usual longitudinal study per se where effects of time come into play.</p></li>
<li><p>Can this dataset be considered a timeseries? Is RNN-LSTM for prediction appropriate in this case?</p></li>
<li><p>Everything I am doing will be a univariate analysis, which is more likely to introduce biasness. Therefore, is more covariates such as age, gender, race available for the MESA study? With that, I could explore interaction between two covariates and see how that affects the outcome.</p></li>
<li><p>The reason why I am having trouble modeling longitudinal progression is because this MESA study does not seem to be a cohort study with time intervals between sLTP measurements. With th dataset provided, I can only study the probabilities of a certain QES (at baseline) transitioning to another (at follow up). Any suggestions?</p></li>
<li><p>Were the 3D coordinates measured at baseline the same ones measured at follow up? What if there was a progression of the disease between baseline and follow up? Were new coordinates measured at follow up if/when that was the case?</p></li>
</ol>
<p><strong>Week 3:</strong></p>
<ol style="list-style-type: decimal">
<li>The suitable dataset format. Tried to model it as time series but I cannot figure out the right format to put the dataset in. Thought I would model baseline and follow up at a time but this approach is not intuitive. Basically changing 3D coordinates into a time series with multiple measurements as columns and different patients’ IDNO as observations.</li>
</ol>
<p><strong>Things to Explore Next Week:</strong></p>
<ol style="list-style-type: decimal">
<li><p>After looking at the Nominal model, I can explore <strong>contigency tables</strong> where different QES categories are treated independently which allows for studying the probabilities of a certain QES transitioning to another. This is an association problem, not prediction.</p></li>
<li><p>The RNN-LSTM if it is appropriate in this instance.</p></li>
</ol>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
